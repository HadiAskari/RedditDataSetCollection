from collections import defaultdict
import json
from collections import Counter

dd=defaultdict(list)
# dic1 = defaultdict(list)
# dic2 = defaultdict(list)

# dic1 = {'a': [1], 'b': [2], 'd': [6]}
# dic2 = {'a': [3,234,5325], 'b': [4,25], 'c': [5,23423,45436,6536,754]}
# dic3 = {'a': [765,238,5329], 'b': [4,25], 'c': [5,23423,45436,6536,754], 'e': [54646, 768]}


huge_json_file= "data-2021-06.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic19=json.load(f)


huge_json_file= "data-2020-05.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic20=json.load(f)




huge_json_file= "data-2021-04.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic1=json.load(f)

huge_json_file= "data-2021-03.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic2=json.load(f)

huge_json_file= "data-2021-02.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic3=json.load(f)

huge_json_file= "data-2021-01.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic4=json.load(f)

huge_json_file= "data-2020-12.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic5=json.load(f)


huge_json_file= "data-2020-11.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic6=json.load(f)


huge_json_file= "data-2020-10.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic7=json.load(f)

huge_json_file= "data-2020-09.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic8=json.load(f)

huge_json_file= "data-2020-08.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic9=json.load(f)

huge_json_file= "data-2020-07.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic10=json.load(f)

huge_json_file= "data-2020-06.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic11=json.load(f)

huge_json_file= "data-2020-05.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic12=json.load(f)

huge_json_file= "data-2020-04.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic13=json.load(f)



huge_json_file= "data-2020-03.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic14=json.load(f)

huge_json_file= "data-2020-02.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic15=json.load(f)

huge_json_file= "data-2020-01.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic16=json.load(f)

huge_json_file= "data-2019-12.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic17=json.load(f)

huge_json_file= "data-2019-11.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic18=json.load(f)

huge_json_file= "data-2019-10.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic21=json.load(f)

huge_json_file= "data-2019-09.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic22=json.load(f)

huge_json_file= "data-2019-08.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic23=json.load(f)

huge_json_file= "data-2019-07.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic24=json.load(f)

huge_json_file= "data-2019-06.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic25=json.load(f)

huge_json_file= "data-2019-05.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic26=json.load(f)

huge_json_file= "data-2019-04.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic27=json.load(f)

huge_json_file= "data-2019-03.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic28=json.load(f)


huge_json_file= "data-2019-02.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic29=json.load(f)

huge_json_file= "data-2019-01.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic30=json.load(f)

huge_json_file= "data-2018-12.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic31=json.load(f)

huge_json_file= "data-2018-11.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic32=json.load(f)


huge_json_file= "data-2018-10.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic33=json.load(f)


huge_json_file= "data-2018-09.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic34=json.load(f)

huge_json_file= "data-2018-08.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic35=json.load(f)

huge_json_file= "data-2018-07.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic36=json.load(f)

huge_json_file= "data-2018-06.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic37=json.load(f)


huge_json_file= "data-2018-05.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic38=json.load(f)


huge_json_file= "data-2018-04.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic39=json.load(f)


huge_json_file= "data-2018-03.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic40=json.load(f)


huge_json_file= "data-2018-02.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic41=json.load(f)

huge_json_file= "data-2018-01.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic42=json.load(f)

huge_json_file= "data-2017-12.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic43=json.load(f)

huge_json_file= "data-2017-11.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic44=json.load(f)

huge_json_file= "data-2017-10.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic45=json.load(f)

huge_json_file= "data-2017-09.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic46=json.load(f)

huge_json_file= "data-2017-08.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic47=json.load(f)


huge_json_file= "data-2017-07.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic48=json.load(f)

huge_json_file= "data-2017-06.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic49=json.load(f)

huge_json_file= "data-2017-05.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic50=json.load(f)


huge_json_file= "data-2017-04.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic51=json.load(f)


huge_json_file= "data-2017-03.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic52=json.load(f)


huge_json_file= "data-2017-02.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic53=json.load(f)


huge_json_file= "data-2017-01.txt"
with open(huge_json_file, "r") as f:
	#print(f.readlines())
	dic54=json.load(f)






# def merge_defaultdicts(d,d1):
#     for k,v in d1.items():
#         if (k in d):
#             d[k].extend(d1[k]) 
#         else:
#             d[k] = d1[k]
#     return d

dics=[dic1,dic2,dic3,dic4,dic5,dic6,dic7,dic8,dic9,dic10,dic11,dic12,dic13,dic14,dic15,dic16,dic17,dic18,dic19,dic20,dic21,dic22,dic23,dic24,dic25,dic26,dic27,dic28,dic29,dic30,dic31,dic32,dic33,dic34,dic35,dic36,dic37,dic38,dic39,dic40,dic41,dic42,dic43,dic44,dic45,dic46,dic47,dic48,dic49,dic50,dic51,dic52,dic53,dic54]

# dics=[dic1,dic2,dic3]


def merge_defaultdicts_list(l1):
	for index in range(len(l1)-1):
		for k,v in l1[index+1].items():
			if (k in l1[0]):
				l1[0][k].extend(l1[index+1][k]) 
			else:
				l1[0][k] = l1[index+1][k]
	return l1[0]


# dd= merge_defaultdicts(dic1, dic2)
dd= merge_defaultdicts_list(dics)

#print (dd)

counts=[]
for k,v in list(dd.items()):
	if len(dd[k]) < 40:
		del dd[k]



for k,v in dd.items():
	counts.append(len(dd[k]))


hist=Counter(counts)
print(type(hist))

dict_hist=dict(hist)
	



a=0
for key, value in dict_hist.items():
	a=a+dict_hist[key]

print(a)

with open('Final_Data.txt', 'w') as convert_file:
				convert_file.write(json.dumps(dd))

